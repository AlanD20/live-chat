(()=>{var e,t={109:()=>{function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}var a=null,s=null,i=null,r=null,o=null,l=null,u=null,c=(i=null,null),d=null,m=null,p=null,f=null,g=null,h=document.querySelectorAll(".dialog"),v=document.querySelector(".help"),y=document.querySelector(".notification"),b=document.querySelector(".about"),L=document.querySelector(".signinInterface"),E=document.querySelector(".messageInterface"),k=document.querySelector(".btn_menu"),w=document.querySelector(".manageChat"),S=document.querySelector(".accountManaging"),T=document.querySelector(".channel-list"),x=document.querySelector(".btn_userChangeName"),q=document.querySelector(".noti"),U=/^[\w-\.]{4,32}$/;firebase.initializeApp({apiKey:"AIzaSyAqOBXVucb27Cb64XyOJQOPaflbj-Dxo7I",authDomain:"livechat-20f11.firebaseapp.com",projectId:"livechat-20f11",messagingSenderId:"360519023193",appId:"1:360519023193:web:4e1f6658ff49a1f91c0f48"});var C=function(){function t(n,a){e(this,t),this.db=firebase.firestore().collection("messages"),this.guest=firebase.firestore().collection("guest"),this.channel=a,this.name=n,this.revoke}return n(t,[{key:"changeChannel",value:function(e){this.channel=e,localStorage.setItem("channel",e),null!=this.revoke&&this.revoke(),this.getChats()}},{key:"addElement",value:function(e,t,n,a){var s=document.createElement("LI");s.dataset.id=e;var i=dateFns.distanceInWordsToNow(new Date(a).toLocaleString(),{addSuffix:!0});return s.innerHTML+="<span>".concat(t,' <span class="TimeCreated">').concat(i,"</span></span>\n\t\t\t\t\t\t\t\t\t\t\t<span>").concat(n,"</span>"),s}},{key:"addNewChat",value:function(e,t,n,s){"guest"==this.channel?this.guest.add({name:e,channel:t,message:n,time:s}):""!==a.msg.value.trim()&&this.db.add({name:e,channel:t,message:n,time:s}).catch((function(e){return P("You don't have permission to send a message.",3e3)}))}},{key:"ks",value:function(e){null==M.auth.currentUser?P("You don't have permission.",3500):(r.parentElement.style.display="flex",r.addEventListener("submit",(function(t){t.preventDefault(),firebase.firestore().collection("cfd").doc(M.auth.currentUser.uid).get().then((function(t){Number(r.vc.value)===t.data().i&&e()})).catch((function(e){return P("You don't have permission.",3500)})),r.parentElement.style.display="none"})))}},{key:"ka",value:function(e){e?this.db.get().then((function(e){e.forEach((function(e){return e.ref.delete()}))})):this.guest.get().then((function(e){e.forEach((function(e){return e.ref.delete()}))}))}},{key:"ko",value:function(e,t){console.log(e),t?(console.log(e),"LI"===e.target.tagName?this.db.doc(e.target.dataset.id).delete():"SPAN"===e.target.tagName&&this.db.doc(e.target.parentElement.dataset.id).delete()):"LI"===e.target.tagName?A.guest.doc(e.target.dataset.id).delete():"SPAN"===e.target.tagName&&A.guest.doc(e.target.parentElement.dataset.id).delete()}},{key:"getChats",value:function(){var e=this;this.clearChat(),"guest"==this.channel?this.revoke=this.guest.orderBy("time","asc").onSnapshot((function(t){t.docChanges().forEach((function(t){if("removed"===t.type)N("A message has been removed",1500),e.removeItems(t.doc),setTimeout((function(e){location.reload()}),2e3);else if("added"===t.type)return N("New Message",1e3),e.addNewItems(t.doc)}))})):this.revoke=this.db.where("channel","==",this.channel).orderBy("time","asc").onSnapshot((function(t){t.docChanges().forEach((function(t){if("removed"===t.type)N("A message has been removed",1500),e.removeItems(t.doc),setTimeout((function(e){location.reload()}),2e3);else{if("added"===t.type)return N("New Message",1e3),e.addNewItems(t.doc);"modified"===t.type&&(N("Updating...",2e3),setTimeout((function(e){location.reload()}),2e3))}}))}),(function(e){return P("You don't have permission to see messages.",3e3)}))}},{key:"addNewItems",value:function(e){return g.prepend(this.addElement(e.id,e.data().name,e.data().message,e.data().time))}},{key:"removeItems",value:function(e){return g.removeChild(document.querySelector('[data-id="'+e.id+'"]'))}},{key:"clearChat",value:function(){null!=g&&Array.from(g.children).forEach((function(e){return e.remove()}))}}]),t}(),A=null,M=new(function(){function t(){e(this,t),this.auth=firebase.auth(),A=new C(null,localStorage.getItem("channel")),this.newUser=!1}return n(t,[{key:"createUser",value:function(e,t,n){var a=this;this.auth.createUserWithEmailAndPassword(e,t).then((function(e){e.user.updateProfile({displayName:n}),a.emailVerification(e.user),N("Account Created successfully! Welcome, ".concat(n,"."),5e3),a.newUser=!0,a.auth.signOut(),setTimeout((function(e){return location.reload()}),1500)})).catch((function(e){console.log("%c"+e.message,"color:red;font-size:x-large;font-weight:600;"),e.message.includes("password")?e.innerText="Your password doesn't meet the requirement.":e.message.includes("email")?c.innerText="Your email doesn't meet the requirement.":c.innerText="Something went wrong, please try again."}))}},{key:"signoutUser",value:function(){var e=this;return this.auth.signOut().then((function(t){e.signupScreen(),N("Goodbye, ".concat(A.name),3500)}))}},{key:"signinUser",value:function(e,t){return this.auth.signInWithEmailAndPassword(e,t).then((function(e){N("Welcome Back, ".concat(e.user.displayName),3500)})).catch((function(e){console.log("%c"+e.message,"color:red;font-size:x-large;font-weight:600;"),e.message.includes("password")?c.innerText="Your password is incorrect.":e.message.includes("email")?c.innerText="Your email is incorrect.":e.message.includes("user record")?c.innerText="Account doesn't exist":c.innerText="Login failed, please try again."}))}},{key:"userCheck",value:function(){var e=this;this.auth.onAuthStateChanged((function(t){null==t||e.newUser?e.signupScreen():(e.signinScreen(),e.channelActive(localStorage.getItem("channel")),e.accountManageAdmin())}))}},{key:"usernameUpdate",value:function(e){var t=this;this.auth.currentUser.updateProfile({displayName:e}).then((function(e){return N("Username updated to ".concat(t.auth.currentUser.displayName,"."),5e3)})),A.name=this.auth.currentUser.displayName,setTimeout((function(e){location.reload()}),2e3)}},{key:"emailVerification",value:function(e){return this.auth.currentUser.emailVerified?N("Your email is already verified.",5e3):e.sendEmailVerification().then((function(e){return P("Please Verify your email.",1e4)}))}},{key:"updateEmail",value:function(e){return this.auth.currentUser.updateEmail(e).then((function(e){return P("Email updated.",3500)}))}},{key:"updatePassword",value:function(e){return this.auth.currentUser.updatePassword(e).then((function(e){return P("Password updated.",3500)}))}},{key:"resetPassword",value:function(e){var t=this;return this.auth.sendPasswordResetEmail(e).then((function(e){P("Reset password link sent to your email.",3500),t.signinForm()})).catch((function(e){console.log("%c"+e.message,"color:red;font-size:x-large;font-weight:600;"),e.message.includes("email")&&(c.innerText="Email doesn't exist.")}))}},{key:"deleteUser",value:function(e){return this.auth.currentUser.delete().then((function(e){return P("Your account deleted.",3500)}))}},{key:"signinScreen",value:function(){this.signinHTML(),this.signinQueries(),(A=new C(this.auth.currentUser.displayName,localStorage.getItem("channel"))).name=this.auth.currentUser.displayName,m.innerText=A.name,this.signinEvents(),A.changeChannel(localStorage.getItem("channel"))}},{key:"signupScreen",value:function(){this.signupHTML(),this.signupQueries(),this.signupEvents()}},{key:"formRegistration",value:function(e){e.classList.contains("btn_signin")?this.signinForm():e.classList.contains("btn_signup")&&this.signupForm()}},{key:"resetForm",value:function(){var e=this;L.innerHTML='<form class="frm reseting" autocomplete="off"><p class="error"></p><span class="signupLabel" >Email Address:</span><input type="text" required autocomplete="email" name="email" class="input inputAccount" maxlength="65" placeholder="Enter your Email" ><input type="submit" value="Reset Passowrd" class="btn btn_account reset"></form>',c=document.querySelector(".error"),(l=document.querySelector(".reseting")).addEventListener("submit",(function(t){t.preventDefault(),e.resetPassword(l.email.value.trim())}))}},{key:"accountManageUser",value:function(){w.innerHTML='<span tabindex="1" class="manage editProfile">Account Setting</span><span tabindex="1" class="manage signout">Sign out</span>'}},{key:"accountManageAdmin",value:function(){firebase.firestore().collection("cfd").doc(this.auth.currentUser.uid).get().then((function(e){e.exists&&(w.innerHTML+='<span tabindex="1" class="manage vf">Clear User Chat</span><span tabindex="1" class="manage vf22">Clear Guest Chat</span>',i=document.querySelector(".vf"),d=document.querySelector(".vf22"),i.addEventListener("click",(function(e){return A.ks((function(e){return A.ka(!0)}))})),d.addEventListener("click",(function(e){return A.ks((function(e){return A.ka(!1)}))})))}))}},{key:"signinHTML",value:function(){k.innerHTML="",k.classList.add("hidden"),L.innerHTML="",T.innerHTML='<li class="list-item"><a href="#" class="item">welcome</a></li><li class="list-item"><a href="#" class="item">general</a></li><li class="list-item"><a href="#" class="item">promote</a></li><li class="list-item"><a href="#" class="item">guest</a></li>',x.innerHTML='<i class="accountIcon far fa-user-circle"></i><span class="showUsername"> </span><i class="editPen fas fa-pen"></i>',this.messageUIcodes(),this.accountManageUser()}},{key:"signupHTML",value:function(){E.innerHTML="",x.innerHTML="",w.innerHTML="",k.classList.remove("hidden"),k.innerHTML='<span tabindex="1" class="manage btn_signup">Sign up</span><span tabindex="1" class="manage btn_signin">Sign in</span>',this.guestChannel(),this.messageUIcodes(),this.signinForm()}},{key:"signinQueries",value:function(){m=document.querySelector(".showUsername"),p=document.querySelectorAll(".list-item"),s=document.querySelector(".inputNameChange"),r=document.querySelector(".inputClearChat")}},{key:"signupQueries",value:function(){document.querySelectorAll(".btn_signup"),document.querySelectorAll(".btn_signin"),o=document.querySelector(".frm_signin"),u=document.querySelector(".frm_signup")}},{key:"signupForm",value:function(){var e=this;E.innerHTML="",T.children[0].classList.remove("active"),L.innerHTML='<form class="frm frm_signup" autocomplete="off"><p class="error"></p><span class="signupLabel">Username:</span><input type="text" autocomplete="username" required name="username" class="input inputAccount" maxlength="65" placeholder="Enter your Username" ><span class="signupLabel">Email Address:</span><input type="email" autocomplete="email" required name="email" class="input inputAccount" maxlength="65" placeholder="Enter your Email" ><span class="signupLabel">Password:</span><input type="password" autocomplete="current-password" required class="input inputAccount" name="password" maxlength="65" minlength="6" placeholder="Enter your password"><input type="submit" value="Sign up" name="signup" class="btn btn_account signup"></form>',c=document.querySelector(".error"),(u=document.querySelector(".frm_signup")).addEventListener("submit",(function(t){t.preventDefault(),e.createUser(u.email.value.trim(),u.password.value,u.username.value.trim())}))}},{key:"signinForm",value:function(){var e=this;E.innerHTML="",T.children[0].classList.remove("active"),L.innerHTML='<form class="frm frm_signin" autocomplete="off"><p class="error"></p><span class="signupLabel" >Email Address:</span><input type="email" required autocomplete="email" name="email" class="input inputAccount" maxlength="65" placeholder="Enter your Email" ><span class="signupLabel">Password:</span><input type="password" autocomplete="current-password" required class="input inputAccount" name="password" maxlength="65" placeholder="Enter your password"><div class="container_signin"><input type="submit" style="order:2;" value="Sign in" name="signin" class="btn signin"><button class="btn reset" style="order:1;margin-inline-start: 2rem;">Reset password</button></div></form>',c=document.querySelector(".error"),(o=document.querySelector(".frm_signin")).addEventListener("click",(function(t){t.preventDefault(),t.target.classList.contains("signin")?e.signinUser(o.email.value.trim(),o.password.value):t.target.classList.contains("reset")&&e.resetForm()})),o.addEventListener("submit",(function(t){t.preventDefault(),e.signinUser(o.email.value.trim(),o.password.value)}))}},{key:"signinEvents",value:function(){var e=this;x.addEventListener("click",(function(t){return e.changeNameTemplate()})),w.addEventListener("click",(function(t){t.preventDefault(),t.target.classList.contains("signout")?M.signoutUser():t.target.classList.contains("editProfile")&&(S.style.display="flex",S.innerHTML="<span>".concat(e.auth.currentUser.email,'</span><button class="btn changeEmail">Change Email</button><button class="btn resetPassword">Change Password</button><button class="btn deleteAccount">Delete account</button>'),S.classList.add("manageProfile"))})),p.forEach((function(t){t.addEventListener("click",(function(t){A.changeChannel(t.target.innerText),e.channelActive(t.target.innerText)}))})),S.addEventListener("click",(function(t){if(t.target.classList.contains("changeEmail")){t.target.parentElement.classList.remove("manageProfile"),t.target.parentElement.innerHTML='<form class="inputChangeEmail" autocomplete="off"><input type="email" class="input inputSmall" name="email" maxlength="65" placeholder="Enter your new email" ><input type="submit" value="Change email" class="btn btn_box"></form>';var n=document.querySelector(".inputChangeEmail");n.addEventListener("submit",(function(t){t.preventDefault(),e.updateEmail(n.email.value.trim()),S.style.display="none"}))}else if(t.target.classList.contains("resetPassword")){t.target.parentElement.classList.remove("manageProfile"),t.target.parentElement.innerHTML='<form class="inputChangePassword"><input type="password" autocomplete="new-password" class="input inputSmall" name="password" maxlength="65" minlength="6" placeholder="Enter your new password" ><input type="submit" value="Change password" class="btn btn_box"></form>';var a=document.querySelector(".inputChangePassword");a.addEventListener("submit",(function(t){t.preventDefault(),e.updatePassword(a.password.value.trim()),S.style.display="none"}))}else if(t.target.classList.contains("deleteAccount")){t.target.parentElement.classList.remove("manageProfile"),t.target.parentElement.innerHTML='<form class="deleteAccountConfirmation"><button class="btn yesDelete">Yes</button><button class="btn noDelete">No</button></form>';var s=document.querySelector(".yesDelete"),i=document.querySelector(".noDelete");s.addEventListener("click",(function(t){t.preventDefault(),e.deleteUser(e.auth.currentUser.email),S.style.display="none",N("Account deleted successfully."),setTimeout((function(e){location.reload()}),2e3)})),i.addEventListener("click",(function(e){e.preventDefault(),S.style.display="none"}))}}))}},{key:"guestChannel",value:function(){var e=this;T.innerHTML='<li class="list-item"><a href="#" class="item">guest</a></li>',T.children[0].children[0].addEventListener("click",(function(t){t.target.parentElement.classList.add("active"),L.innerHTML="",e.messageUIcodes(),A.changeChannel(t.target.innerText)}))}},{key:"channelActive",value:function(e){p.forEach((function(t){t.innerHTML.includes(e)?t.classList.add("active"):t.classList.remove("active")}))}},{key:"messageUIcodes",value:function(){var e=this;E.innerHTML='<ul class="messages"></ul><div class="inputMessageInterface"><form class="inputMessage" autocomplete="off"><input type="text" class="input" name="msg" maxlength="255" placeholder="Enter your message..." ><input type="submit" value="Send" name="send" class="btn btn_box"><span data-length="" name="counter" class="counter"></span></form></div>',f=document.querySelector(".counter"),a=document.querySelector(".inputMessage"),(g=document.querySelector(".messages")).addEventListener("dblclick",(function(t){firebase.firestore().collection("cfd").doc(e.auth.currentUser.uid).get().then((function(e){"guest"===A.channel?A.ks((function(e){return A.ko(t,!1)})):A.ks((function(e){return A.ko(t,!0)}))})).catch((function(e){}))})),a.addEventListener("submit",(function(t){t.preventDefault(),null==A.name?A.addNewChat("guest",A.channel,a.msg.value.trim(),Number((new Date).getTime())):A.addNewChat(e.auth.currentUser.displayName,A.channel,a.msg.value.trim(),Number((new Date).getTime())),a.reset(),f.dataset.length=0,f.classList.remove("exceeded")})),a.addEventListener("input",(function(e){255===a.msg.value.length?f.classList.add("exceeded"):f.classList.remove("exceeded"),f.dataset.length=a.msg.value.length}))}},{key:"signupEvents",value:function(){var e=this;k.addEventListener("click",(function(t){return e.formRegistration(t.target)}))}},{key:"changeNameTemplate",value:function(){var e=this;s.parentElement.style.display="flex",s.addEventListener("submit",(function(t){t.preventDefault(),""!==s.name.value&&s.name.value.match(U)&&(e.usernameUpdate(s.name.value.trim()),m.innerText=A.name,s.parentElement.style.display="none",s.reset(),P("Welcome to the chat!",1500))})),s.addEventListener("keyup",(function(e){s.name.value.match(U)?e.target.style.color="green":e.target.style.color="red"}))}}]),t}());function N(e,t){y.style.opacity="1",y.innerText=e,setTimeout((function(e){return y.style.opacity="0"}),t)}function P(e,t){q.style.opacity="1",q.innerText=e,setTimeout((function(e){return q.style.opacity="0"}),t)}window.addEventListener("load",(function(e){null===localStorage.getItem("channel")&&localStorage.setItem("channel","guest"),M.userCheck()})),h.forEach((function(e){return e.addEventListener("click",(function(t){t.target.classList.contains("dialog")&&(e.style.display="none",document.querySelectorAll("input[type=text]").forEach((function(e){return e.value=""})))}))})),v.addEventListener("click",(function(e){e.preventDefault(),b.style.display="flex",b.addEventListener("click",(function(e){"SPAN"!==e.target.tagName&&"H2"!==e.target.tagName||(e.target.parentElement.style.display="none")}))}))},202:()=>{}},n={};function a(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,a),i.exports}a.m=t,e=[],a.O=(t,n,s,i)=>{if(!n){var r=1/0;for(c=0;c<e.length;c++){for(var[n,s,i]=e[c],o=!0,l=0;l<n.length;l++)(!1&i||r>=i)&&Object.keys(a.O).every((e=>a.O[e](n[l])))?n.splice(l--,1):(o=!1,i<r&&(r=i));if(o){e.splice(c--,1);var u=s();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,s,i]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={704:0,296:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var s,i,[r,o,l]=n,u=0;if(r.some((t=>0!==e[t]))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var c=l(a)}for(t&&t(n);u<r.length;u++)i=r[u],a.o(e,i)&&e[i]&&e[i][0](),e[r[u]]=0;return a.O(c)},n=self.webpackChunklivechat=self.webpackChunklivechat||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.O(void 0,[296],(()=>a(109)));var s=a.O(void 0,[296],(()=>a(202)));s=a.O(s)})();